#!/bin/sh -e

APP="/ProfitTrailer"
APPDATA="/appdata"
CONFIG="$APPDATA/config"
TRADING="$CONFIG/trading"
DATA="$APPDATA/data"
LOGS="$APPDATA/logs"

files="application.properties configuration.properties"
for file in $files; do
  if [ -f "$CONFIG/$file" ]; then
    ln -sf "$CONFIG/$file" "$APP/$file"
  else
    echo "$file not found in $CONFIG" 1>&2
    exit 1
  fi
done

mkdir -p "$TRADING"
rm -r "$APP/trading"
ln -s "$TRADING" "$APP/trading"

ln -s "$LOGS" "$APP/logs"

mkdir -p $DATA/backup
ln -s "$DATA/backup" "$APP/backup"

datapaths="ProfitTrailerData.json ProfitTrailerData.json.backup"
for datapath in $datapaths; do
  touch "$DATA/$datapath"
  ln -s "$DATA/$datapath" "$APP/$datapath"
done

exec pt
